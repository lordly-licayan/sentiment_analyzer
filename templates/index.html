<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Model Training Dashboard</title>
    <link rel="stylesheet" href="/static/css/style.css" />
  </head>
  <body>
    <div class="container">
      <!-- TAB HEADERS -->
      <div class="tabs">
        <div class="tab active" onclick="openTab('models')">Models</div>
        <div class="tab" onclick="openTab('train_model')">Train Model</div>
        <div class="tab" onclick="openTab('uploaded_files')">Uploaded Files</div>
        <div class="tab" onclick="openTab('comments')">View Comments</div>
        <div class="tab" onclick="openTab('playground')">Playground</div>
      </div>

      <!-- MODELS TAB -->
      <div id="models" class="tab-content active">
        <h2>Trained Models</h2>
        <table>
          <thead>
            <tr>
              <th>No.</th>
              <th>SY</th>
              <th>Semester</th>
              <th>Model Name</th>
              <th>Model </th>
              <th>Accuracy</th>
              <th>No. Of Data</th>
              <th>Date Trained</th>
              <th>Remarks</th>
              <th>Action</th>
            </tr>
          </thead>
          <tbody id="models-tbody">
            <!-- {% for m in models %}
            <tr>
              <td>{{ m.sy }}</td>
              <td>{{ m.semester }}</td>
              <td>{{ m.model_name }}</td>
              <td>{{ m.classifier }}</td>
              <td>{{ m.accuracy }}%</td>
              <td>{{ m.no_of_data }}</td>
              <td>{{ m.date_trained }}</td>
              <td>{{ m.remarks }}</td>
            </tr>
            {% endfor %} -->
          </tbody>
        </table>
      </div>

      <!-- TRAIN A MODEL TAB -->
      <div id="train_model" class="tab-content">
        <h2>Upload CSV for training a model</h2>
        <div
          style="display: flex; gap: 10px; align-items: center; margin: 10px"
        >
          <label style="min-width: 50px">Model Name</label>
          <input
            type="text"
            id="modelName"
            name="model_name"
            value="{{ default_model_name }}"
            class="text-input"
          />
        </div>
        <div id="dropzone" class="dropzone">
          Drag & Drop CSV here<br /><br />
          or click to browse
        </div>

        <input type="file" id="fileInput" accept=".csv" style="display: none" />
        <div id="fileName"></div>

        <div style="display: flex; gap: 10px; align-items: center">
          <select id="schoolYearSelect">
            <option value="">Select School Year</option>
            {% for sy in school_years %}
            <option value="{{ sy }}">{{ sy }}</option>
            {% endfor %}
          </select>

          <select id="semesterSelect">
            <option value="">Select Semester</option>
            {% for sem in semesters %}
            <option value="{{ sem }}">{{ sem }}</option>
            {% endfor %}
          </select>
          <label>Classifier Model:</label>
          <select id="classifierModel">
              {% for item in supported_classifiers %}
                  <option 
                      value="{{ item }}"
                      {% if item == default_classifier %}selected{% endif %}
                  >
                      {{ item }}
                  </option>
              {% endfor %}
          </select>
          <button id="trainBtn" onclick="train_model()">Train</button>
        </div>
        <!-- Progress Bar Section -->
        <div id="progressContainer">
          <div id="progressLabel"> Initializing...</div>
          <div id="progressBarContainer">
            <div id="progressBar"></div>
          </div>
          <div id="progressPercent"> 0% </div>
        </div>
        <div id="report-info">
          <p>Status: <span id="status"></span></p>
          <p>Message: <span id="message"></span></p>
          <p>Accuracy: <span id="accuracy"></span></p>
          <p>Elapsed time: <span id="elapsedTime"></span></p>
          <p>Report: <span id="report"></span></p>
          <p>Feedback: <span id="feedback"></span></p>
        </div>
      </div>

      <!-- UPLOADED FILES TAB -->
      <div id="uploaded_files" class="tab-content">
        <h2>Uploaded Files</h2>

        <table class="strict-table">
          <thead>
            <tr>
              <th style="width: 3%;">No.</th>
              <th style="width: 20%;">Filename</th>
              <th style="width: 9%;">No. of Data</th>
              <th style="width: 15%;">Date Uploaded</th>
              <th style="width: 48%;" class="remarks">Remarks</th>
              <th style="width: 9%;">Action</th>
            </tr>
          </thead>
          <tbody id="uploaded-files-tbody">
            <!-- {% for f in uploaded_files %}
            <tr>
              <td>{{ f.filename }}</td>
              <td>{{ f.no_of_data }}</td>
              <td>{{ f.date_uploaded }}</td>
              <td>{{ f.remarks or "" }}</td>
              <td>
                <button class="btn btn-view" onclick="openComments('{{ f.file_id }}')">
                  Comments
                </button>
              </td>
            </tr>
            {% endfor %} -->
          </tbody>
        </table>
      </div>

      <!-- VIEW COMMENTS TAB -->
      <div id="comments" class="tab-content">
        <h2 id="comments_desc">Comments</h2>
        <!-- Search box -->
        <div>
        <input 
          type="text" 
          id="comment-search" 
          placeholder="Search comment..." 
          style="margin-bottom: 10px; padding: 6px; width: 450px;"
        />
        </div>
        <table>
          <thead>
            <tr>
              <th>No.</th>
              <th>Comment</th>
              <th>Label</th>
              <th>Remarks</th>
            </tr>
          </thead>
          <tbody id="comments-tbody">
            <!-- {% for c in comments %}
            <tr>
              <td>{{ c.comment }}</td>
              <td>{{ c.label }}</td>
              <td>{{ c.remarks }}</td>
            </tr>
            {% endfor %} -->
          </tbody>
        </table>
      </div>

      <!-- PLAYGROUND TAB -->
      <div id="playground" class="tab-content">
        <div class="sentiment-analysis">
          <h3>Sentiment Analysis</h3>
  
          <!-- Dropdown for trained models -->
          <label for="model-select">Select Model:</label>
          <select id="model-select" style="width: 100%; margin-bottom: 10px;">
            <option value="">-- Select a model --</option>
            <!-- Options will be populated dynamically -->
          </select>
          
          <!-- Input textbox -->
          <textarea id="comments-box" rows="5" placeholder="Enter your comment here..." style="width:100%;"></textarea>

          <!-- Sentiment button -->
          <button id="sentiment-btn" class="btn btn-primary" style="margin-top: 5px; font-size: 20px; " onclick="get_sentiments()">
            Sentiment
          </button>

          <!-- Display sentiment result -->
          <div id="sentiment-result" style="margin-top: 10px; font-weight: bold;">
            <!-- Sentiments-->
          </div>

          <div id="sentiment-spinner" style="display:none; text-align:center; margin:20px;">
            Generating...
            <div class="loader"></div>
          </div>
          </div>
      </div>
    </div>
    <style>
        /* Simple CSS spinner */
        .loader {
          border: 8px solid #f3f3f3; /* Light gray */
          border-top: 8px solid #3498db; /* Blue */
          border-radius: 50%;
          width: 40px;
          height: 40px;
          animation: spin 1s linear infinite;
          margin: auto;
        }

        @keyframes spin {
          0% { transform: rotate(0deg); }
          100% { transform: rotate(360deg); }
        }

        .spinner-border {
          display: inline-block;
          width: 2rem;
          height: 2rem;
          vertical-align: text-bottom;
          border: 0.25em solid #FF0000;
          border-right-color: transparent;
          border-radius: 50%;
          animation: spinner-border 0.75s linear infinite;
        }

        @keyframes spinner-border {
          100% {
            transform: rotate(360deg);
          }
        }

        .spinner-border-sm {
          width: 1rem;
          height: 1rem;
          border-width: 0.2em;
        }
      </style>
    <script src="/static/js/script.js"></script>
  </body>
</html>
