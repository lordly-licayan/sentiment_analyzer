<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Sentiment Training Dashboard</title>
    <link
      rel="stylesheet"
      href="{{ url_for('static', path='/css/style.css') }}"
    />
  </head>
  <body>
    <div class="container">
      <!-- TAB HEADERS -->
      <div class="tabs">
        <div class="tab active" onclick="openTab('models')">Models</div>
        <div class="tab" onclick="openTab('train_model')">Train Model</div>
        <div class="tab" onclick="openTab('files')">Uploaded Files</div>
        <div class="tab" onclick="openTab('comments')">View Comments</div>
        <div class="tab" onclick="openTab('report')">Report</div>
      </div>

      <!-- MODELS TAB -->
      <div id="models" class="tab-content active">
        <h2>Trained Models</h2>
        <table>
          <thead>
            <tr>
              <th>SY</th>
              <th>Semester</th>
              <th>Model Name</th>
              <th>Model </th>
              <th>Accuracy</th>
              <th>No. Of Data</th>
              <th>Date Trained</th>
              <th>Remarks</th>
            </tr>
          </thead>
          <tbody>
            {% for m in models %}
            <tr>
              <td>{{ m.SY }}</td>
              <td>{{ m.Semester }}</td>
              <td>{{ m.ModelName }}</td>
              <td>{{ m.Location }}</td>
              <td>{{ m.NoOfData }}</td>
              <td>{{ m.TrainedDate }}</td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>

      <!-- TRAIN A MODEL TAB -->
      <div id="train_model" class="tab-content">
        <h2>Upload CSV for training a model</h2>
        <div
          style="display: flex; gap: 10px; align-items: center; margin: 10px"
        >
          <label style="min-width: 50px">Model Name</label>
          <input
            type="text"
            id="modelName"
            name="model_name"
            value="{{ default_model_name }}"
            class="text-input"
          />
        </div>
        <div id="dropzone" class="dropzone">
          Drag & Drop CSV here<br /><br />
          or click to browse
        </div>

        <input type="file" id="fileInput" accept=".csv" style="display: none" />
        <div id="fileName"></div>

        <div style="display: flex; gap: 10px; align-items: center">
          <select id="schoolYearSelect">
            <option value="">Select School Year</option>
            {% for sy in school_years %}
            <option value="{{ sy }}">{{ sy }}</option>
            {% endfor %}
          </select>

          <select id="semesterSelect">
            <option value="">Select Semester</option>
            {% for sem in semesters %}
            <option value="{{ sem }}">{{ sem }}</option>
            {% endfor %}
          </select>
          <label>Classifier Model:</label>
          <select id="classifierModel">
              {% for item in supported_classifiers %}
                  <option 
                      value="{{ item }}"
                      {% if item == default_classifier %}selected{% endif %}
                  >
                      {{ item }}
                  </option>
              {% endfor %}
          </select>
          <button id="trainBtn" onclick="train_model()">Train</button>
        </div>
        <!-- Progress Bar Section -->
        <div id="progressContainer">
          <div id="progressLabel"> Initializing...</div>
          <div id="progressBarContainer">
            <div id="progressBar"></div>
          </div>
          <div id="progressPercent"> 0% </div>
        </div>
        <div id="report-info">
          <p>Status: <span id="status"></span></p>
          <p>Message: <span id="message"></span></p>
          <p>Accuracy: <span id="accuracy"></span></p>
          <p>Elapsed time: <span id="elapsedTime"></span></p>
          <p>Report: <span id="report"></span></p>
          <p>Feedback: <span id="feedback"></span></p>
        </div>
      </div>

      <!-- UPLOADED FILES TAB -->
      <div id="files" class="tab-content">
        <h2>Uploaded Files</h2>

        <table>
          <thead>
            <tr>
              <th>Filename</th>
              <th>No Of Data</th>
              <th>Date Uploaded</th>
              <th>Remarks</th>
            </tr>
          </thead>
          <tbody>
            {% for f in uploaded_files %}
            <tr>
              <td>{{ f.Filename }}</td>
              <td>{{ f.NoOfData }}</td>
              <td>{{ f.DateUploaded }}</td>
              <td>{{ f.Remarks }}</td>       
              <td>
                <!-- <button class="btn btn-view" onclick="viewComments({{ f.Id }})">
                  Comments
                </button>
                <button class="btn btn-report" onclick="viewReport({{ f.Id }})">
                  Report
                </button> -->
                <button class="btn btn-view" >
                  Comments
                </button>
                <button class="btn btn-report" >
                  Report
                </button>
              </td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>

      <!-- VIEW COMMENTS TAB -->
      <div id="comments" class="tab-content">
        <h2>Comments</h2>

        <table>
          <thead>
            <tr>
              <th>Comment</th>
              <th>Label</th>
              <th>Is Trained Data</th>
            </tr>
          </thead>
          <tbody id="commentsTable">
            {% for c in comments %}
            <tr>
              <td>{{ c.Comment }}</td>
              <td>{{ c.Label }}</td>
              <td>{{ c.IsTrainedData }}</td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>

      <!-- REPORT TAB -->
      <div id="report" class="tab-content">
        <h2>Training Reports</h2>

        <table>
          <thead>
            <tr>
              <th>Trained Data Filename</th>
              <th>Test Data Filename</th>
              <th>Processed Date</th>
              <th>Report</th>
            </tr>
          </thead>
          <tbody>
            {% for r in training_reports %}
            <tr>
              <td>{{ r.TrainedFilename }}</td>
              <td>{{ r.TestFilename }}</td>
              <td>{{ r.ProcessedDate }}</td>
              <td>{{ r.Report }}</td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    </div>

    <script src="/static/script/app.js"></script>
  </body>
</html>
